<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ” | Kubermates</title><meta name=description content="When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS..."><meta property="og:url" content="https://kubermates.org/blog/automating-dns-in-azure-private-dns-with-external-dns-3knk/"><meta property="og:site_name" content="Kubermates"><meta property="og:title" content="Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”"><meta property="og:description" content="When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS..."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-12-29T17:07:48+00:00"><meta property="article:modified_time" content="2024-12-29T17:07:48+00:00"><meta itemprop=name content="Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”"><meta itemprop=description content="When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS..."><meta itemprop=datePublished content="2024-12-29T17:07:48+00:00"><meta itemprop=dateModified content="2024-12-29T17:07:48+00:00"><meta itemprop=wordCount content="1131"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”"><meta name=twitter:description content="When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS..."><link rel=preload href=/scss/main.min.e8cc45d85315a21706a63b6ac89bd1b180ed25b3b643edc182d2d0d09e89769e.css as=style integrity="sha256-6MxF2FMVohcGpjtqyJvRsYDtJbO2Q+3BgtLQ0J6Jdp4=" crossorigin=anonymous><link href=/scss/main.min.e8cc45d85315a21706a63b6ac89bd1b180ed25b3b643edc182d2d0d09e89769e.css rel=stylesheet integrity="sha256-6MxF2FMVohcGpjtqyJvRsYDtJbO2Q+3BgtLQ0J6Jdp4=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><link rel=icon href=/images/favicon.ico></head><body class="td-page td-blog"><header><nav class="navbar navbar-expand-lg navbar-dark bg-primary"><div class=container-fluid><a class=navbar-brand href=https://kubermates.org/><img src=/images/logo.png alt="Kubermates Logo" height=40 class="d-inline-block align-text-top">
Kubermates
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/blog/>Articles</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class=nav-item><a class=nav-link href=/contribute/>Contribute</a></li></ul></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-blog-li><a href=/blog/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-blog><span>Blogs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogfirst-post-li><a href=/blog/first-post/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogfirst-post><span>launching kubermates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloggithub-actions-composite-vs-reusable-workflows-4bih-li><a href=/blog/github-actions-composite-vs-reusable-workflows-4bih/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloggithub-actions-composite-vs-reusable-workflows-4bih><span>ğŸ§© GitHub Actions Composite vs Reusable Workflows</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogelevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc-li><a href=/blog/elevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogelevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc><span>ğŸš€ğŸŒ Elevating Infrastructure: From Terraform/Terragrunt Foundations to Platform Engineering ğŸ˜Š</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecure-secret-management-with-sops-in-helm-1940-li><a href=/blog/secure-secret-management-with-sops-in-helm-1940/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecure-secret-management-with-sops-in-helm-1940><span>ğŸ” Secure Secret Management with SOPS in Helm ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecure-secret-management-with-sops-in-terraform-terragrunt-231a-li><a href=/blog/secure-secret-management-with-sops-in-terraform-terragrunt-231a/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecure-secret-management-with-sops-in-terraform-terragrunt-231a><span>ğŸ” Secure Secret Management with SOPS in Terraform & Terragrunt</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghelm-chart-essentials-writing-effective-charts-11ca-li><a href=/blog/helm-chart-essentials-writing-effective-charts-11ca/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghelm-chart-essentials-writing-effective-charts-11ca><span>Helm Chart Essentials & Writing Effective Charts ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunlocking-secrets-with-external-secrets-operator-2f89-li><a href=/blog/unlocking-secrets-with-external-secrets-operator-2f89/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunlocking-secrets-with-external-secrets-operator-2f89><span>Unlocking Secrets with External Secrets Operator ğŸ”âœ¨</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-blogautomating-dns-in-azure-private-dns-with-external-dns-3knk-li><a href=/blog/automating-dns-in-azure-private-dns-with-external-dns-3knk/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-blogautomating-dns-in-azure-private-dns-with-external-dns-3knk><span class=td-sidebar-nav-active-item>Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogusing-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh-li><a href=/blog/using-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogusing-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh><span>Using Nginx Ingress Controller and Cert-Manager for HTTPS with Letâ€™s Encrypt âš¡</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0-li><a href=/blog/ensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0><span>Ensuring Effective Helm Charts with Linting, Testing, and Diff Checks ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogcapsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5-li><a href=/blog/capsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogcapsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5><span>Capsule: How to Use It and First Steps to Set It Up on an AKS Cluster ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh-li><a href=/blog/understanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh><span>Understanding AKS NAP: Azure Kubernetes Service Node Auto-Provisioning (Powered by Karpenter) ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogadmission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d-li><a href=/blog/admission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogadmission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d><span>Admission Controllers in Kubernetes: OPA GateKeeper, Kyverno, and Azure Policy Add-on for AKSâ€”Which One Wins? ğŸ†</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogupgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap-li><a href=/blog/upgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogupgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap><span>Upgrading AKS: In-Place, Blue-Green, and Canary Upgrades Explained ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogmonitor-and-optimize-multi-cluster-aks-costs-4627-li><a href=/blog/monitor-and-optimize-multi-cluster-aks-costs-4627/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogmonitor-and-optimize-multi-cluster-aks-costs-4627><span>Monitor and Optimize Multi-Cluster AKS Costs ğŸ’°</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogenhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida-li><a href=/blog/enhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogenhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida><span>ğŸš€ Enhancing Container Security: The Complete Guide to Secure and Clean Kubernetes Clusters ğŸ›¡ï¸ğŸ§¼</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkarmada-deep-dive-into-managing-multiple-aks-clusters-1j08-li><a href=/blog/karmada-deep-dive-into-managing-multiple-aks-clusters-1j08/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkarmada-deep-dive-into-managing-multiple-aks-clusters-1j08><span>Karmada: Deep Dive into Managing Multiple AKS Clusters ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-ebpf-and-its-application-in-modern-cloud-environments-3f99-li><a href=/blog/understanding-ebpf-and-its-application-in-modern-cloud-environments-3f99/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-ebpf-and-its-application-in-modern-cloud-environments-3f99><span>Understanding eBPF and Its Application in Modern Cloud Environments ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecuring-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k-li><a href=/blog/securing-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecuring-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k><span>ğŸŒ Securing Kubernetes Secrets in AKS: Using Azure Key Vault with Managed and User Assigned Identities ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogautomating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l-li><a href=/blog/automating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogautomating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l><span>ğŸš€ Automating Image Vulnerability Patching in Kubernetes with Trivy Operator, Copacetic, and GitHub Actions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogautoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo-li><a href=/blog/autoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogautoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo><span>Autoscaling in Kubernetes: KEDA, Karpenter, and Native Autoscalers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloginsights-on-securing-your-kubernetes-cluster-with-falco-4b9g-li><a href=/blog/insights-on-securing-your-kubernetes-cluster-with-falco-4b9g/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloginsights-on-securing-your-kubernetes-cluster-with-falco-4b9g><span>Insights on Securing Your Kubernetes Cluster with Falco ğŸš€ğŸ”’</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogbuilding-a-kubernetes-operator-with-an-nginx-crd-3lil-li><a href=/blog/building-a-kubernetes-operator-with-an-nginx-crd-3lil/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogbuilding-a-kubernetes-operator-with-an-nginx-crd-3lil><span>ğŸš€ Building a Kubernetes Operator with an NGINX CRD</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l-li><a href=/blog/hacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l><span>ğŸ¨ Hacking the Helm Operator with Flux: Creating Self-Installable Services for Easier App Deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogchaos-engineering-lets-break-everything-io0-li><a href=/blog/chaos-engineering-lets-break-everything-io0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogchaos-engineering-lets-break-everything-io0><span>Chaos Engineering Let's Break Everything! ğŸ˜ˆ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloga-guide-to-modern-kubernetes-service-networking-4017-li><a href=/blog/a-guide-to-modern-kubernetes-service-networking-4017/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloga-guide-to-modern-kubernetes-service-networking-4017><span>A Guide to Modern Kubernetes Service Networking ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogeffective-vulnerability-monitoring-in-kubernetes-1mge-li><a href=/blog/effective-vulnerability-monitoring-in-kubernetes-1mge/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogeffective-vulnerability-monitoring-in-kubernetes-1mge><span>ğŸ›¡ï¸ Effective Vulnerability Monitoring in Kubernetes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkubernetes-multi-cluster-management-1nek-li><a href=/blog/kubernetes-multi-cluster-management-1nek/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-multi-cluster-management-1nek><span>Kubernetes Multi-Cluster Management ğŸ“¦</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-make-your-docker-images-go-on-a-diet-88l-li><a href=/blog/how-to-make-your-docker-images-go-on-a-diet-88l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-make-your-docker-images-go-on-a-diet-88l><span>How to Make Your Docker Images Go on a Diet ğŸŠâ€â™‚ï¸</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloga-quick-navigation-through-service-mesh-in-kubernetes-5dea-li><a href=/blog/a-quick-navigation-through-service-mesh-in-kubernetes-5dea/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloga-quick-navigation-through-service-mesh-in-kubernetes-5dea><span>A quick navigation through Service Mesh in Kubernetes ğŸ‘€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkubernetes-rbac-and-role-aggregation-made-easy-3j4o-li><a href=/blog/kubernetes-rbac-and-role-aggregation-made-easy-3j4o/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-rbac-and-role-aggregation-made-easy-3j4o><span>ğŸš€ Kubernetes RBAC and Role Aggregation Made Easy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogessential-tips-for-setting-resource-limits-in-kubernetes-3b54-li><a href=/blog/essential-tips-for-setting-resource-limits-in-kubernetes-3b54/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogessential-tips-for-setting-resource-limits-in-kubernetes-3b54><span>Essential Tips for Setting Resource Limits in Kubernetes ğŸ“ˆ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3-li><a href=/blog/kubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3><span>ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-manage-kubernetes-app-storage-like-a-pro-o33-li><a href=/blog/how-to-manage-kubernetes-app-storage-like-a-pro-o33/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-manage-kubernetes-app-storage-like-a-pro-o33><span>How to Manage Kubernetes App Storage Like a Pro ğŸ“</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2-li><a href=/blog/understanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2><span>Understanding Pod Topology Spread Constraints and Node Affinity in Kubernetes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec-li><a href=/blog/how-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec><span>How to Test the Latest Kubernetes Changes in Version 1.31 "Elli"</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/kubermates-org/kubermates-site/tree/main/content/blog/2024-12-29-automating-dns-in-azure-private-dns-with-external-dns-3knk.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/kubermates-org/kubermates-site/edit/main/content/blog/2024-12-29-automating-dns-in-azure-private-dns-with-external-dns-3knk.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/kubermates-org/kubermates-site/new/main/content/blog?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/kubermates-org/kubermates-site/issues/new?title=Automating%20DNS%20in%20Azure%20Private%20DNS%20with%20External-DNS%20%e2%98%81%ef%b8%8f%f0%9f%94%90" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#why-use-azure-workload-identity>Why Use Azure Workload Identity?</a></li><li><a href=#prerequisites-checklist->Prerequisites Checklist âœ…</a></li><li><a href=#setting-up-azure-private-dns>Setting Up Azure Private DNS</a></li><li><a href=#create-a-user-assigned-managed-identity-uami->Create a User-Assigned Managed Identity (UAMI) ğŸ”‘</a></li><li><a href=#enable-azure-workload-identity-on-your-cluster>Enable Azure Workload Identity on Your Cluster</a></li><li><a href=#the-valuesyaml-snippet-explained>The <code>values.yaml</code> Snippet Explained</a><ul><li><a href=#key-sections-breakdown>Key Sections Breakdown</a></li></ul></li><li><a href=#deploying-external-dns-via-helm->Deploying External-DNS via Helm ğŸ—ï¸</a></li><li><a href=#example-creating-an-ingress>Example: Creating an Ingress</a></li><li><a href=#validation-and-troubleshooting->Validation and Troubleshooting ğŸ·ï¸</a></li><li><a href=#wrapping-up->Wrapping Up ğŸ</a><ul><li><a href=#key-takeaways>Key Takeaways**</a></li><li><a href=#further-reading>Further Reading</a></li></ul></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tags</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://kubermates.org/tags/announcement/ data-taxonomy-term=announcement><span class=taxonomy-label>Announcement</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/automation/ data-taxonomy-term=automation><span class=taxonomy-label>Automation</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/aws/ data-taxonomy-term=aws><span class=taxonomy-label>Aws</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/azure/ data-taxonomy-term=azure><span class=taxonomy-label>Azure</span><span class=taxonomy-count>13</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cicd/ data-taxonomy-term=cicd><span class=taxonomy-label>Cicd</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloud/ data-taxonomy-term=cloud><span class=taxonomy-label>Cloud</span><span class=taxonomy-count>28</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloudnative/ data-taxonomy-term=cloudnative><span class=taxonomy-label>Cloudnative</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cncf/ data-taxonomy-term=cncf><span class=taxonomy-label>Cncf</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/community/ data-taxonomy-term=community><span class=taxonomy-label>Community</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/containers/ data-taxonomy-term=containers><span class=taxonomy-label>Containers</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/devops/ data-taxonomy-term=devops><span class=taxonomy-label>Devops</span><span class=taxonomy-count>6</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/docker/ data-taxonomy-term=docker><span class=taxonomy-label>Docker</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/falco/ data-taxonomy-term=falco><span class=taxonomy-label>Falco</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/finops/ data-taxonomy-term=finops><span class=taxonomy-label>Finops</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/github/ data-taxonomy-term=github><span class=taxonomy-label>Github</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/githubactions/ data-taxonomy-term=githubactions><span class=taxonomy-label>Githubactions</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/gitops/ data-taxonomy-term=gitops><span class=taxonomy-label>Gitops</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/karmada/ data-taxonomy-term=karmada><span class=taxonomy-label>Karmada</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/kubernetes/ data-taxonomy-term=kubernetes><span class=taxonomy-label>Kubernetes</span><span class=taxonomy-count>29</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/networking/ data-taxonomy-term=networking><span class=taxonomy-label>Networking</span><span class=taxonomy-count>4</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/opensource/ data-taxonomy-term=opensource><span class=taxonomy-label>Opensource</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/platform-engineering/ data-taxonomy-term=platform-engineering><span class=taxonomy-label>Platform-Engineering</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/productivity/ data-taxonomy-term=productivity><span class=taxonomy-label>Productivity</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/programming/ data-taxonomy-term=programming><span class=taxonomy-label>Programming</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/security/ data-taxonomy-term=security><span class=taxonomy-label>Security</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/servicemesh/ data-taxonomy-term=servicemesh><span class=taxonomy-label>Servicemesh</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/terraform/ data-taxonomy-term=terraform><span class=taxonomy-label>Terraform</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/terragrunt/ data-taxonomy-term=terragrunt><span class=taxonomy-label>Terragrunt</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/trivy/ data-taxonomy-term=trivy><span class=taxonomy-label>Trivy</span><span class=taxonomy-count>1</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role=main><a class=td-rss-button title=RSS href=/blog/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss" aria-hidden=true></i></a><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/blog/>Blogs</a></li><li class="breadcrumb-item active" aria-current=page>Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”</li></ol></nav><div class=td-content><h1>Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”</h1><div class=lead>When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS&mldr;</div><div class="td-byline mb-4"><time datetime=2024-12-29 class=text-body-secondary>Sunday, December 29, 2024</time></div><header class=article-meta></header><p><em>When running Kubernetes in Azure, one of the biggest time-savers you can implement is automatic DNS record managementâ€”especially for internal (private) services. By integrating <a href=https://github.com/kubernetes-sigs/external-dns>External-DNS</a> with Azure Private DNS, you can say goodbye to manual record updates. Better yet, you can skip traditional service principals and use Azure Workload Identity to make your cluster more secure and secrets-free!</em> ğŸš€</p><p>In this article, weâ€™ll show you how to configure External-DNS for Azure Private DNS using <strong>Azure Workload Identity</strong>, leveraging a snippet of a <code>values.yaml</code> that highlights the relevant settings.</p><h2 id=why-use-azure-workload-identity>Why Use Azure Workload Identity?</h2><p>Traditionally, External-DNS needs service principal credentials (client ID and secret) to manage DNS records. Azure Workload Identity allows you to integrate with Azure AD <strong>without storing or distributing credential secrets</strong> in Kubernetes. It utilizes the identity granted to your pods at runtime (managed identity) to request access tokens from Azure AD securely. This:</p><ul><li><strong>Eliminates</strong> the need for manual secret management.</li><li><strong>Reduces</strong> the risk of compromised secrets.</li><li><strong>Simplifies</strong> your Kubernetes-to-Azure authentication setup.</li></ul><blockquote><p><strong>Note</strong>: Azure Workload Identity is now <strong>Generally Available (GA)</strong>, so you no longer need to enable preview features.</p></blockquote><h2 id=prerequisites-checklist->Prerequisites Checklist âœ…</h2><ol><li><strong>Kubernetes Cluster</strong>: An AKS cluster or self-managed cluster on Azure.</li><li><strong>Azure Private DNS Zone</strong>:<ul><li>e.g. <code>example.internal</code>, already created in your Azure subscription.</li></ul></li><li><strong>User-Assigned Managed Identity (UAMI)</strong> created in Azure with the appropriate permissions (e.g., <code>DNS Zone Contributor</code>) on the DNS zone resource group.</li><li><strong>Azure Workload Identity components</strong> installed on your cluster (this typically involves the <a href=https://azure.github.io/azure-workload-identity/docs/>Azure AD Workload Identity</a> setup steps).</li><li><strong>External-DNS</strong> Helm chart or YAML files ready to deploy.</li></ol><h2 id=setting-up-azure-private-dns>Setting Up Azure Private DNS</h2><p>If you havenâ€™t created your Private DNS zone yet, you can do so quickly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>az network private-dns zone create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group &lt;RESOURCE_GROUP&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name example.internal
</span></span></code></pre></div><p>Then, link it to your Virtual Network so internal DNS can be resolved:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>az network private-dns link vnet create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group &lt;RESOURCE_GROUP&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --zone-name example.internal <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name myVnetLink <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --virtual-network &lt;VNET_ID&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --registration-enabled false
</span></span></code></pre></div><p>Replace <code>&lt;RESOURCE_GROUP></code> and <code>&lt;VNET_ID></code> with values for your environment.</p><h2 id=create-a-user-assigned-managed-identity-uami->Create a User-Assigned Managed Identity (UAMI) ğŸ”‘</h2><ol><li><p><strong>Create the UAMI</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>az identity create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name external-dns-identity <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group &lt;RESOURCE_GROUP&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --location &lt;LOCATION&gt;
</span></span></code></pre></div><p>This command returns JSON that includes an <code>id</code> and a <code>clientId</code> (important for later steps).</p></li><li><p><strong>Assign the Role</strong><br>Give the identity <code>DNS Zone Contributor</code> on your DNS zone resource group or at the subscription level:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>az role assignment create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --assignee &lt;CLIENT_ID_OF_UAMI&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --role <span style=color:#e6db74>&#34;DNS Zone Contributor&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --scope /subscriptions/&lt;SUBSCRIPTION_ID&gt;/resourceGroups/&lt;RESOURCE_GROUP&gt;
</span></span></code></pre></div></li></ol><blockquote><p><strong>Note</strong>: The <code>clientId</code> is also referred to as the â€œApplication IDâ€ of the managed identity.</p></blockquote><h2 id=enable-azure-workload-identity-on-your-cluster>Enable Azure Workload Identity on Your Cluster</h2><p>Azure Workload Identity is <strong>GA</strong> (generally available), so you donâ€™t need to enable any preview features. However, you <strong>do</strong> need to install the necessary components in your cluster. Follow the <a href=https://azure.github.io/azure-workload-identity/docs/installation.html>official installation guide</a> to:</p><ol><li>Install the Azure Workload Identity webhook in your cluster.</li><li>Configure a <strong>Federated Identity Credential</strong> referencing your clusterâ€™s issuer and the service account youâ€™ll create. This typically happens when you use the <a href=https://azure.github.io/azure-workload-identity/docs/installation.html#azure-workload-identity-cli-azwi>azwi CLI tool</a> or manually configure a federated identity in your managed identity.</li></ol><h2 id=the-valuesyaml-snippet-explained>The <code>values.yaml</code> Snippet Explained</h2><p>Below is an example of a <code>values.yaml</code> you could use with the <a href=https://github.com/kubernetes-sigs/external-dns/tree/master/charts/external-dns>External-DNS Helm chart</a>. It integrates <strong>Azure Workload Identity</strong> and <strong>Private DNS</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>podLabels</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;azure.workload.identity/use&#34;: </span><span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>serviceAccount</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;azure.workload.identity/use&#34;: </span><span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;azure.workload.identity/client-id&#34;: </span><span style=color:#e6db74>&#34;&lt;CLIENT_ID_OF_UAMI&gt;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>automountServiceAccountToken</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>logLevel</span>: <span style=color:#ae81ff>debug</span>
</span></span><span style=display:flex><span><span style=color:#f92672>logFormat</span>: <span style=color:#ae81ff>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>interval</span>: <span style=color:#ae81ff>1m</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>provider</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-private-dns</span> <span style=color:#75715e># or &#39;azure&#39; for public DNS</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>sources</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>ingress</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>dnsPolicy</span>: <span style=color:#ae81ff>Default</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>domainFilters</span>: 
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>example.internal</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraVolumes</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-config-file</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>secret</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>&lt;SECRET_NAME&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraVolumeMounts</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-config-file</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/etc/kubernetes/</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>readOnly</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h3 id=key-sections-breakdown>Key Sections Breakdown</h3><ol><li><p><strong>Workload Identity Labels & Annotations</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>podLabels</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;azure.workload.identity/use&#34;: </span><span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>serviceAccount</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>create</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;azure.workload.identity/use&#34;: </span><span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;azure.workload.identity/client-id&#34;: </span><span style=color:#e6db74>&#34;&lt;UAMI_CLIENT_ID&gt;&#34;</span>
</span></span></code></pre></div><ul><li>Tells Azure Workload Identity that pods in this deployment should use the user-assigned managed identity.</li><li>The <code>client-id</code> annotation is the <strong>Application ID</strong> of your UAMI (from the step where you created the identity).</li></ul></li><li><p><strong>Provider</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>provider</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-private-dns</span>
</span></span></code></pre></div><ul><li>Tells External-DNS weâ€™re using Azure Private DNS.</li><li>For public DNS, use <code>azure</code>.</li></ul></li><li><p><strong>Sources</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>sources</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>ingress</span>
</span></span></code></pre></div><ul><li>External-DNS will create DNS records for ingresses (you can also add <code>service</code> or <code>crd</code> as needed).</li></ul></li><li><p><strong>Domain Filters</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>domainFilters</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;example.internal&#34;</span>
</span></span></code></pre></div><ul><li>Ensures External-DNS only manages DNS records for <code>example.internal</code>.</li></ul></li><li><p><strong>extraVolumes & extraVolumeMounts</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraVolumes</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-config-file</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>secret</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>&lt;SECRET_NAME&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraVolumeMounts</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>azure-config-file</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/etc/kubernetes/</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>readOnly</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><ul><li>If you still have minimal config in a secret (like subscription info or region), you can mount it.</li><li><strong>Note</strong>: With Azure Workload Identity, you typically donâ€™t need a full credential file. If you do, it should not include any secrets, since the identity token is handled automatically.</li></ul></li></ol><h2 id=deploying-external-dns-via-helm->Deploying External-DNS via Helm ğŸ—ï¸</h2><p>Once you have your <code>values.yaml</code> ready, deploy or upgrade External-DNS:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo add external-dns https://kubernetes-sigs.github.io/external-dns/
</span></span><span style=display:flex><span>helm repo update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>helm upgrade --install external-dns external-dns/external-dns <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --namespace external-dns --create-namespace <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --values values.yaml
</span></span></code></pre></div><p>This will create:</p><ul><li>A <strong>Deployment</strong> for External-DNS in the <code>external-dns</code> namespace.</li><li>A <strong>ServiceAccount</strong> with the appropriate labels/annotations for Azure Workload Identity.</li><li>Pods automatically requesting a token from Azure AD using the user-assigned managed identity, eliminating the need for storing a client secret.</li></ul><h2 id=example-creating-an-ingress>Example: Creating an Ingress</h2><p>External-DNS will watch for ingresses (since we set <code>sources: [ingress]</code>). Hereâ€™s a simple example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-app</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>external-dns.alpha.kubernetes.io/hostname</span>: <span style=color:#e6db74>&#34;app.example.internal&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>host</span>: <span style=color:#e6db74>&#34;app.example.internal&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>pathType</span>: <span style=color:#ae81ff>Prefix</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-service</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>port</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>number</span>: <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>External-DNS sees this annotation, and automatically:</p><ol><li>Authenticates to Azure via Workload Identity.</li><li>Creates/Updates the DNS record <code>app.example.internal</code> in your private DNS zone to point to the ingress controllerâ€™s IP.</li></ol><p><em>Zero manual DNS stepsâ€”just pure automation.</em> ğŸ¤–ğŸ‰</p><h2 id=validation-and-troubleshooting->Validation and Troubleshooting ğŸ·ï¸</h2><ol><li><p><strong>Check Pod Logs</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs -f deploy/external-dns -n external-dns
</span></span></code></pre></div><ul><li>You should see lines about detecting the ingress and creating/updating records.</li></ul></li><li><p><strong>Verify the DNS Record</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>az network private-dns record-set a list <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --zone-name example.internal <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --resource-group &lt;RESOURCE_GROUP&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --output table
</span></span></code></pre></div><ul><li>Look for <code>app</code> in the list of A records.</li></ul></li><li><p><strong>Ensure Proper Role Assignments</strong></p><ul><li>If External-DNS logs show permission errors, confirm the user-assigned identity has <code>DNS Zone Contributor</code>.</li></ul></li><li><p><strong>Double-Check the Domain Filter</strong></p><ul><li>If your ingress annotation uses a domain not in <code>domainFilters</code>, External-DNS will ignore it.</li></ul></li><li><p><strong>Federated Identity Setup</strong></p><ul><li>If youâ€™re getting token or identity errors, confirm your federated identity configuration (on the UAMI in Azure) matches the service accountâ€™s annotation and your clusterâ€™s issuer URL.</li></ul></li></ol><h2 id=wrapping-up->Wrapping Up ğŸ</h2><p>By combining <strong>External-DNS</strong> with <strong>Azure Workload Identity</strong> for your <strong>Azure Private DNS</strong> zones, youâ€™ll have a secure, low-maintenance system for automatic DNS record management. No more storing service principal secrets, no more manual DNS updatesâ€”just a smooth, automated workflow.</p><h3 id=key-takeaways>Key Takeaways**</h3><ul><li>Azure Workload Identity = no secrets needed!</li><li>External-DNS automates DNS record lifecycle for your cluster.</li><li>Private DNS means internal-only resolutionâ€”ideal for microservices and closed environments.</li></ul><p>Give this setup a spin, and watch your DNS woes disappear! âœ¨</p><h3 id=further-reading>Further Reading</h3><ul><li><a href=https://github.com/kubernetes-sigs/external-dns>External-DNS GitHub</a></li><li><a href=https://azure.github.io/azure-workload-identity/docs/>Azure Workload Identity Docs</a></li><li><a href=https://docs.microsoft.com/azure/dns/private-dns-overview>Azure Private DNS Overview</a></li></ul><p><strong>Happy Automating</strong> and may your internal DNS always resolve! ğŸ‰</p><p>Happy Clustering ! ğŸŒŸ</p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/blog/using-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh/ aria-label="Previous - Using Nginx Ingress Controller and Cert-Manager for HTTPS with Letâ€™s Encrypt âš¡" class="btn btn-primary"><span class=me-1>â†</span>Previous</a></li><li><a href=/blog/unlocking-secrets-with-external-secrets-operator-2f89/ aria-label="Next - Unlocking Secrets with External Secrets Operator ğŸ”âœ¨" class="btn btn-primary">Next<span class=ms-1>â†’</span></a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025
<span class=td-footer__authors>Kubermates powered by Kapheira</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.d844e8cb3c2d74f005336b0c873045728e53ff0ce5534c7d8563fa0676a87b08.js integrity="sha256-2EToyzwtdPAFM2sMhzBFco5T/wzlU0x9hWP6Bnaoewg=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/tabpane-persist.js></script></body></html>