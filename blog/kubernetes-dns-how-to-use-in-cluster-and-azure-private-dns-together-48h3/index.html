<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together | Kubermates</title><meta name=description content="Kubernetes is a powerful platform for managing containerized applications, providing robust tools for..."><meta property="og:url" content="https://kubermates.org/blog/kubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3/"><meta property="og:site_name" content="Kubermates"><meta property="og:title" content="ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together"><meta property="og:description" content="Kubernetes is a powerful platform for managing containerized applications, providing robust tools for..."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-08-17T17:51:44+00:00"><meta property="article:modified_time" content="2024-08-17T17:51:44+00:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Azure"><meta property="article:tag" content="Cloud"><meta property="article:tag" content="Networking"><meta itemprop=name content="ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together"><meta itemprop=description content="Kubernetes is a powerful platform for managing containerized applications, providing robust tools for..."><meta itemprop=datePublished content="2024-08-17T17:51:44+00:00"><meta itemprop=dateModified content="2024-08-17T17:51:44+00:00"><meta itemprop=wordCount content="1189"><meta itemprop=keywords content="Kubernetes,Azure,Cloud,Networking"><meta name=twitter:card content="summary"><meta name=twitter:title content="ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together"><meta name=twitter:description content="Kubernetes is a powerful platform for managing containerized applications, providing robust tools for..."><link rel=preload href=/scss/main.min.197a4af99ef9ed3dfd33450e7627d46f0285eb67fc3e6acc5ca34da69932fa68.css as=style integrity="sha256-GXpK+Z757T39M0UOdifUbwKF62f8PmrMXKNNppky+mg=" crossorigin=anonymous><link href=/scss/main.min.197a4af99ef9ed3dfd33450e7627d46f0285eb67fc3e6acc5ca34da69932fa68.css rel=stylesheet integrity="sha256-GXpK+Z757T39M0UOdifUbwKF62f8PmrMXKNNppky+mg=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><link rel=icon type=image/x-icon href=/images/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><meta name=theme-color content="#00D1B2"></head><body class="td-page td-blog"><header><nav class="navbar navbar-expand-lg navbar-dark bg-primary"><div class=container-fluid><a class=navbar-brand href=https://kubermates.org/><img src=/images/nav-logo-white.png srcset="/images/nav-logo-white.png 1x, /images/nav-logo-white@2x.png 2x" alt=Kubermates width=auto height=48>
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ms-auto mb-2 mb-lg-0"><li class=nav-item><a class=nav-link href=/blog/>Articles</a></li><li class=nav-item><a class=nav-link href=/events/>Events</a></li><li class=nav-item><a class=nav-link href=/docs/>Docs</a></li><li class=nav-item><a class=nav-link href=/releases/>Releases</a></li><li class=nav-item><a class=nav-link href=/contribute/>Contribute</a></li></ul></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-blog-li><a href=/blog/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-blog><span>Blogs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogfirst-post-li><a href=/blog/first-post/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogfirst-post><span>launching kubermates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloggithub-actions-composite-vs-reusable-workflows-4bih-li><a href=/blog/github-actions-composite-vs-reusable-workflows-4bih/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloggithub-actions-composite-vs-reusable-workflows-4bih><span>ğŸ§© GitHub Actions Composite vs Reusable Workflows</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogelevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc-li><a href=/blog/elevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogelevating-infrastructure-from-terraformterragrunt-foundations-to-platform-engineering-41fc><span>ğŸš€ğŸŒ Elevating Infrastructure: From Terraform/Terragrunt Foundations to Platform Engineering ğŸ˜Š</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecure-secret-management-with-sops-in-helm-1940-li><a href=/blog/secure-secret-management-with-sops-in-helm-1940/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecure-secret-management-with-sops-in-helm-1940><span>ğŸ” Secure Secret Management with SOPS in Helm ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecure-secret-management-with-sops-in-terraform-terragrunt-231a-li><a href=/blog/secure-secret-management-with-sops-in-terraform-terragrunt-231a/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecure-secret-management-with-sops-in-terraform-terragrunt-231a><span>ğŸ” Secure Secret Management with SOPS in Terraform & Terragrunt</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghelm-chart-essentials-writing-effective-charts-11ca-li><a href=/blog/helm-chart-essentials-writing-effective-charts-11ca/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghelm-chart-essentials-writing-effective-charts-11ca><span>Helm Chart Essentials & Writing Effective Charts ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunlocking-secrets-with-external-secrets-operator-2f89-li><a href=/blog/unlocking-secrets-with-external-secrets-operator-2f89/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunlocking-secrets-with-external-secrets-operator-2f89><span>Unlocking Secrets with External Secrets Operator ğŸ”âœ¨</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogautomating-dns-in-azure-private-dns-with-external-dns-3knk-li><a href=/blog/automating-dns-in-azure-private-dns-with-external-dns-3knk/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogautomating-dns-in-azure-private-dns-with-external-dns-3knk><span>Automating DNS in Azure Private DNS with External-DNS â˜ï¸ğŸ”</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogusing-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh-li><a href=/blog/using-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogusing-nginx-ingress-controller-and-cert-manager-for-https-with-lets-encrypt-2flh><span>Using Nginx Ingress Controller and Cert-Manager for HTTPS with Letâ€™s Encrypt âš¡</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0-li><a href=/blog/ensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogensuring-effective-helm-charts-with-linting-testing-and-diff-checks-ni0><span>Ensuring Effective Helm Charts with Linting, Testing, and Diff Checks ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogcapsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5-li><a href=/blog/capsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogcapsule-how-to-use-it-and-first-steps-to-set-it-up-on-an-aks-cluster-5hl5><span>Capsule: How to Use It and First Steps to Set It Up on an AKS Cluster ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh-li><a href=/blog/understanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-aks-nap-azure-kubernetes-service-node-auto-provisioning-powered-by-karpenter-3djh><span>Understanding AKS NAP: Azure Kubernetes Service Node Auto-Provisioning (Powered by Karpenter) ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogadmission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d-li><a href=/blog/admission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogadmission-controllers-in-kubernetes-opa-gatekeeper-kyverno-and-azure-policy-add-on-for-aks-which-one-wins-237d><span>Admission Controllers in Kubernetes: OPA GateKeeper, Kyverno, and Azure Policy Add-on for AKSâ€”Which One Wins? ğŸ†</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogupgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap-li><a href=/blog/upgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogupgrading-aks-in-place-blue-green-and-canary-upgrades-explained-3aap><span>Upgrading AKS: In-Place, Blue-Green, and Canary Upgrades Explained ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogmonitor-and-optimize-multi-cluster-aks-costs-4627-li><a href=/blog/monitor-and-optimize-multi-cluster-aks-costs-4627/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogmonitor-and-optimize-multi-cluster-aks-costs-4627><span>Monitor and Optimize Multi-Cluster AKS Costs ğŸ’°</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogenhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida-li><a href=/blog/enhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogenhancing-container-security-the-complete-guide-to-secure-and-clean-kubernetes-clusters-1ida><span>ğŸš€ Enhancing Container Security: The Complete Guide to Secure and Clean Kubernetes Clusters ğŸ›¡ï¸ğŸ§¼</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkarmada-deep-dive-into-managing-multiple-aks-clusters-1j08-li><a href=/blog/karmada-deep-dive-into-managing-multiple-aks-clusters-1j08/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkarmada-deep-dive-into-managing-multiple-aks-clusters-1j08><span>Karmada: Deep Dive into Managing Multiple AKS Clusters ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-ebpf-and-its-application-in-modern-cloud-environments-3f99-li><a href=/blog/understanding-ebpf-and-its-application-in-modern-cloud-environments-3f99/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-ebpf-and-its-application-in-modern-cloud-environments-3f99><span>Understanding eBPF and Its Application in Modern Cloud Environments ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogsecuring-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k-li><a href=/blog/securing-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogsecuring-kubernetes-secrets-in-aks-using-azure-key-vault-with-managed-and-user-assigned-identities-569k><span>ğŸŒ Securing Kubernetes Secrets in AKS: Using Azure Key Vault with Managed and User Assigned Identities ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogautomating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l-li><a href=/blog/automating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogautomating-image-vulnerability-patching-in-kubernetes-with-trivy-operator-copacetic-and-github-actions-13l><span>ğŸš€ Automating Image Vulnerability Patching in Kubernetes with Trivy Operator, Copacetic, and GitHub Actions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogautoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo-li><a href=/blog/autoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogautoscaling-in-kubernetes-keda-karpenter-and-native-autoscalers-1gpo><span>Autoscaling in Kubernetes: KEDA, Karpenter, and Native Autoscalers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloginsights-on-securing-your-kubernetes-cluster-with-falco-4b9g-li><a href=/blog/insights-on-securing-your-kubernetes-cluster-with-falco-4b9g/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloginsights-on-securing-your-kubernetes-cluster-with-falco-4b9g><span>Insights on Securing Your Kubernetes Cluster with Falco ğŸš€ğŸ”’</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogbuilding-a-kubernetes-operator-with-an-nginx-crd-3lil-li><a href=/blog/building-a-kubernetes-operator-with-an-nginx-crd-3lil/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogbuilding-a-kubernetes-operator-with-an-nginx-crd-3lil><span>ğŸš€ Building a Kubernetes Operator with an NGINX CRD</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l-li><a href=/blog/hacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghacking-the-helm-operator-with-flux-creating-self-installable-services-for-easier-app-deployment-5a8l><span>ğŸ¨ Hacking the Helm Operator with Flux: Creating Self-Installable Services for Easier App Deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogchaos-engineering-lets-break-everything-io0-li><a href=/blog/chaos-engineering-lets-break-everything-io0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogchaos-engineering-lets-break-everything-io0><span>Chaos Engineering Let's Break Everything! ğŸ˜ˆ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloga-guide-to-modern-kubernetes-service-networking-4017-li><a href=/blog/a-guide-to-modern-kubernetes-service-networking-4017/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloga-guide-to-modern-kubernetes-service-networking-4017><span>A Guide to Modern Kubernetes Service Networking ğŸš€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogeffective-vulnerability-monitoring-in-kubernetes-1mge-li><a href=/blog/effective-vulnerability-monitoring-in-kubernetes-1mge/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogeffective-vulnerability-monitoring-in-kubernetes-1mge><span>ğŸ›¡ï¸ Effective Vulnerability Monitoring in Kubernetes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkubernetes-multi-cluster-management-1nek-li><a href=/blog/kubernetes-multi-cluster-management-1nek/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-multi-cluster-management-1nek><span>Kubernetes Multi-Cluster Management ğŸ“¦</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-make-your-docker-images-go-on-a-diet-88l-li><a href=/blog/how-to-make-your-docker-images-go-on-a-diet-88l/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-make-your-docker-images-go-on-a-diet-88l><span>How to Make Your Docker Images Go on a Diet ğŸŠâ€â™‚ï¸</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloga-quick-navigation-through-service-mesh-in-kubernetes-5dea-li><a href=/blog/a-quick-navigation-through-service-mesh-in-kubernetes-5dea/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloga-quick-navigation-through-service-mesh-in-kubernetes-5dea><span>A quick navigation through Service Mesh in Kubernetes ğŸ‘€</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogkubernetes-rbac-and-role-aggregation-made-easy-3j4o-li><a href=/blog/kubernetes-rbac-and-role-aggregation-made-easy-3j4o/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-rbac-and-role-aggregation-made-easy-3j4o><span>ğŸš€ Kubernetes RBAC and Role Aggregation Made Easy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogessential-tips-for-setting-resource-limits-in-kubernetes-3b54-li><a href=/blog/essential-tips-for-setting-resource-limits-in-kubernetes-3b54/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogessential-tips-for-setting-resource-limits-in-kubernetes-3b54><span>Essential Tips for Setting Resource Limits in Kubernetes ğŸ“ˆ</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-blogkubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3-li><a href=/blog/kubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-blogkubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3><span class=td-sidebar-nav-active-item>ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-manage-kubernetes-app-storage-like-a-pro-o33-li><a href=/blog/how-to-manage-kubernetes-app-storage-like-a-pro-o33/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-manage-kubernetes-app-storage-like-a-pro-o33><span>How to Manage Kubernetes App Storage Like a Pro ğŸ“</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogunderstanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2-li><a href=/blog/understanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-blogunderstanding-pod-topology-spread-constraints-and-node-affinity-in-kubernetes-49a2><span>Understanding Pod Topology Spread Constraints and Node Affinity in Kubernetes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghow-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec-li><a href=/blog/how-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-bloghow-to-test-the-latest-kubernetes-changes-in-version-131-elli-39ec><span>How to Test the Latest Kubernetes Changes in Version 1.31 "Elli"</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/kubermates-org/kubermates-site/tree/main/content/blog/2024-08-17-kubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/kubermates-org/kubermates-site/edit/main/content/blog/2024-08-17-kubernetes-dns-how-to-use-in-cluster-and-azure-private-dns-together-48h3.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/kubermates-org/kubermates-site/new/main/content/blog?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/kubermates-org/kubermates-site/issues/new?title=%f0%9f%8c%90%20Kubernetes%20DNS:%20How%20to%20Use%20In-Cluster%20and%20Azure%20Private%20DNS%20Together" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#-understanding-kubernetes-services-and-dns-resolution>ğŸ” Understanding Kubernetes Services and DNS Resolution</a><ul><li><a href=#-types-of-kubernetes-services>ğŸ› ï¸ Types of Kubernetes Services</a></li><li><a href=#-dns-resolution-inside-the-kubernetes-cluster>ğŸ§© DNS Resolution Inside the Kubernetes Cluster</a></li></ul></li><li><a href=#-integrating-and-using-azure-private-dns-with-kubernetes>ğŸŒ Integrating and Using Azure Private DNS with Kubernetes</a><ul><li><a href=#step-1-set-up-azure-private-dns>Step 1: Set Up Azure Private DNS</a></li><li><a href=#step-2-configure-kubernetes-pods-to-use-azure-private-dns>Step 2: Configure Kubernetes Pods to Use Azure Private DNS</a></li><li><a href=#step-3-test-dns-resolution>Step 3: Test DNS Resolution</a></li></ul></li><li><a href=#-combining-internal-cluster-dns-with-azure-private-dns>ğŸŒ Combining Internal Cluster DNS with Azure Private DNS</a><ul><li><a href=#-the-clusterfirst-dns-policy>ğŸ“š The <code>ClusterFirst</code> DNS Policy</a></li><li><a href=#-benefits-of-combining-internal-and-azure-private-dns>âš™ï¸ Benefits of Combining Internal and Azure Private DNS</a></li></ul></li><li><a href=#-comparing-private-domains-resolution-with-external-names>ğŸ”„ Comparing Private Domains Resolution with External Names</a><ul><li><a href=#-private-domains-with-azure-private-dns>ğŸ” Private Domains with Azure Private DNS</a></li><li><a href=#-external-names-with-externalname-service>ğŸŒ External Names with <code>ExternalName</code> Service</a></li><li><a href=#-key-differences>ğŸ“ Key Differences</a></li></ul></li><li><a href=#-conclusion>ğŸ Conclusion</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tags</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://kubermates.org/tags/announcement/ data-taxonomy-term=announcement><span class=taxonomy-label>Announcement</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/automation/ data-taxonomy-term=automation><span class=taxonomy-label>Automation</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/aws/ data-taxonomy-term=aws><span class=taxonomy-label>Aws</span><span class=taxonomy-count>23</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/azure/ data-taxonomy-term=azure><span class=taxonomy-label>Azure</span><span class=taxonomy-count>13</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cicd/ data-taxonomy-term=cicd><span class=taxonomy-label>Cicd</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloud/ data-taxonomy-term=cloud><span class=taxonomy-label>Cloud</span><span class=taxonomy-count>28</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloud-foundation/ data-taxonomy-term=cloud-foundation><span class=taxonomy-label>Cloud-Foundation</span><span class=taxonomy-count>74</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloudnative/ data-taxonomy-term=cloudnative><span class=taxonomy-label>Cloudnative</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cncf/ data-taxonomy-term=cncf><span class=taxonomy-label>Cncf</span><span class=taxonomy-count>347</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/community/ data-taxonomy-term=community><span class=taxonomy-label>Community</span><span class=taxonomy-count>54</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/containers/ data-taxonomy-term=containers><span class=taxonomy-label>Containers</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/devops/ data-taxonomy-term=devops><span class=taxonomy-label>Devops</span><span class=taxonomy-count>5</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/docker/ data-taxonomy-term=docker><span class=taxonomy-label>Docker</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/eks/ data-taxonomy-term=eks><span class=taxonomy-label>Eks</span><span class=taxonomy-count>54</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/event/ data-taxonomy-term=event><span class=taxonomy-label>Event</span><span class=taxonomy-count>278</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/falco/ data-taxonomy-term=falco><span class=taxonomy-label>Falco</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/finops/ data-taxonomy-term=finops><span class=taxonomy-label>Finops</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/github/ data-taxonomy-term=github><span class=taxonomy-label>Github</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/githubactions/ data-taxonomy-term=githubactions><span class=taxonomy-label>Githubactions</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/gitops/ data-taxonomy-term=gitops><span class=taxonomy-label>Gitops</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/gke/ data-taxonomy-term=gke><span class=taxonomy-label>Gke</span><span class=taxonomy-count>78</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/grafana/ data-taxonomy-term=grafana><span class=taxonomy-label>Grafana</span><span class=taxonomy-count>11</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/jenkins-x/ data-taxonomy-term=jenkins-x><span class=taxonomy-label>Jenkins-X</span><span class=taxonomy-count>50</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/k3s/ data-taxonomy-term=k3s><span class=taxonomy-label>K3s</span><span class=taxonomy-count>25</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/karmada/ data-taxonomy-term=karmada><span class=taxonomy-label>Karmada</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/kodekloud/ data-taxonomy-term=kodekloud><span class=taxonomy-label>Kodekloud</span><span class=taxonomy-count>23</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/kubeflow/ data-taxonomy-term=kubeflow><span class=taxonomy-label>Kubeflow</span><span class=taxonomy-count>13</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/kubernetes/ data-taxonomy-term=kubernetes><span class=taxonomy-label>Kubernetes</span><span class=taxonomy-count>538</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/networking/ data-taxonomy-term=networking><span class=taxonomy-label>Networking</span><span class=taxonomy-count>4</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/nirmata/ data-taxonomy-term=nirmata><span class=taxonomy-label>Nirmata</span><span class=taxonomy-count>24</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/openshift/ data-taxonomy-term=openshift><span class=taxonomy-label>Openshift</span><span class=taxonomy-count>35</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/opensource/ data-taxonomy-term=opensource><span class=taxonomy-label>Opensource</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/productivity/ data-taxonomy-term=productivity><span class=taxonomy-label>Productivity</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/programming/ data-taxonomy-term=programming><span class=taxonomy-label>Programming</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/rancher/ data-taxonomy-term=rancher><span class=taxonomy-label>Rancher</span><span class=taxonomy-count>74</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/rke/ data-taxonomy-term=rke><span class=taxonomy-label>Rke</span><span class=taxonomy-count>14</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/rke2/ data-taxonomy-term=rke2><span class=taxonomy-label>Rke2</span><span class=taxonomy-count>26</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/rss/ data-taxonomy-term=rss><span class=taxonomy-label>Rss</span><span class=taxonomy-count>10</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/security/ data-taxonomy-term=security><span class=taxonomy-label>Security</span><span class=taxonomy-count>17</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/servicemesh/ data-taxonomy-term=servicemesh><span class=taxonomy-label>Servicemesh</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/terraform/ data-taxonomy-term=terraform><span class=taxonomy-label>Terraform</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/terragrunt/ data-taxonomy-term=terragrunt><span class=taxonomy-label>Terragrunt</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/tigera/ data-taxonomy-term=tigera><span class=taxonomy-label>Tigera</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/trivy/ data-taxonomy-term=trivy><span class=taxonomy-label>Trivy</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/vmware/ data-taxonomy-term=vmware><span class=taxonomy-label>Vmware</span><span class=taxonomy-count>74</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role=main><a class=td-rss-button title=RSS href=/blog/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss" aria-hidden=true></i></a><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/blog/>Blogs</a></li><li class="breadcrumb-item active" aria-current=page>ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together</li></ol></nav><div class=td-content><h1>ğŸŒ Kubernetes DNS: How to Use In-Cluster and Azure Private DNS Together</h1><div class=lead>Kubernetes is a powerful platform for managing containerized applications, providing robust tools for&mldr;</div><div class="td-byline mb-4"><time datetime=2024-08-17 class=text-body-secondary>Saturday, August 17, 2024</time></div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://kubermates.org/tags/kubernetes/ data-taxonomy-term=kubernetes><span class=taxonomy-label>Kubernetes</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/azure/ data-taxonomy-term=azure><span class=taxonomy-label>Azure</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/cloud/ data-taxonomy-term=cloud><span class=taxonomy-label>Cloud</span></a></li><li><a class=taxonomy-term href=https://kubermates.org/tags/networking/ data-taxonomy-term=networking><span class=taxonomy-label>Networking</span></a></li></ul></div></header><p>Kubernetes is a powerful platform for managing containerized applications, providing robust tools for networking, service discovery, and DNS resolution. This guide will explore how Kubernetes handles DNS resolution within the cluster and how you can integrate it with Azure Private DNS to securely resolve external, private resources.</p><h2 id=-understanding-kubernetes-services-and-dns-resolution>ğŸ” Understanding Kubernetes Services and DNS Resolution</h2><p>Kubernetes Services provide a stable network identity for a set of Pods, allowing other components to communicate with them reliably. This is crucial since Pods in Kubernetes are ephemeral and their IP addresses can change over time.</p><h3 id=-types-of-kubernetes-services>ğŸ› ï¸ Types of Kubernetes Services</h3><p>Kubernetes supports several types of Services, each tailored to different use cases:</p><ol><li><strong>ClusterIP</strong> ğŸ : Exposes the Service on an internal IP, making it accessible only within the cluster.</li><li><strong>NodePort</strong> ğŸŒ: Exposes the Service on each Nodeâ€™s IP at a static port, allowing external access.</li><li><strong>LoadBalancer</strong> âš–ï¸: Exposes the Service externally using a cloud providerâ€™s load balancer.</li><li><strong>ExternalName</strong> ğŸ”—: Maps the Service to an external DNS name, returning a CNAME record with that name.</li></ol><h3 id=-dns-resolution-inside-the-kubernetes-cluster>ğŸ§© DNS Resolution Inside the Kubernetes Cluster</h3><p>Kubernetes automatically sets up a DNS system within the cluster, enabling Pods to resolve Services using DNS names. This makes service discovery straightforward, allowing Pods to communicate with each other seamlessly.</p><h4 id=example-resolving-a-service-inside-the-cluster>Example: Resolving a Service Inside the Cluster</h4><p>Consider a Service named <code>web-service</code> in the <code>default</code> namespace:</p><ol><li><p><strong>Service Definition</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>web-app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></div></li><li><p><strong>DNS Resolution</strong>:</p><ul><li><strong>From the same namespace</strong>: A Pod in the <code>default</code> namespace can resolve the Service by simply using <code>web-service</code>.</li><li><strong>From a different namespace</strong>: A Pod in the <code>production</code> namespace would use the full DNS name: <code>web-service.default.svc.cluster.local</code>.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Inside a Pod in the default namespace</span>
</span></span><span class=line><span class=cl>curl http://web-service
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Inside a Pod in the production namespace</span>
</span></span><span class=line><span class=cl>curl http://web-service.default.svc.cluster.local
</span></span></code></pre></div></li></ol><p>This built-in DNS system ensures that all Services in the cluster are easily discoverable and accessible by their names.</p><h2 id=-integrating-and-using-azure-private-dns-with-kubernetes>ğŸŒ Integrating and Using Azure Private DNS with Kubernetes</h2><p>In scenarios where your Kubernetes applications need to resolve private resources hosted in Azure, you can configure your Pods to use Azure Private DNS. Azure Private DNS provides a secure and isolated DNS service within your Azure virtual network (VNet), enabling private domain name resolution.</p><h3 id=step-1-set-up-azure-private-dns>Step 1: Set Up Azure Private DNS</h3><p>First, ensure that your Azure Private DNS Zone is set up within your Azure environment. This DNS zone should be linked to your virtual network to enable private DNS resolution within that VNet.</p><h3 id=step-2-configure-kubernetes-pods-to-use-azure-private-dns>Step 2: Configure Kubernetes Pods to Use Azure Private DNS</h3><p>You can specify Azure Private DNS servers using the <code>dnsConfig</code> field in the Pod specification.</p><h4 id=example-using-azure-private-dns-for-resolution>Example: Using Azure Private DNS for Resolution</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>azure-private-dns-example</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>my-app-image</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsConfig</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nameservers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>10.0.0.4</span><span class=w>  </span><span class=c># Example IP of the Azure Private DNS resolver within your VNet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>searches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>myprivatedomain.internal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>None</span><span class=w>
</span></span></span></code></pre></div><p>Replace <code>10.0.0.4</code> with the IP address of the Azure Private DNS resolver within your virtual network. This IP address is typically the address of the DNS server provided by Azure&rsquo;s VNet.</p><h3 id=step-3-test-dns-resolution>Step 3: Test DNS Resolution</h3><p>After deploying the Pod, you can test DNS resolution to ensure it&rsquo;s using Azure Private DNS:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Inside the Pod</span>
</span></span><span class=line><span class=cl>nslookup myapp.myprivatedomain.internal
</span></span></code></pre></div><p>This command should successfully resolve the private domain using Azure Private DNS.</p><h2 id=-combining-internal-cluster-dns-with-azure-private-dns>ğŸŒ Combining Internal Cluster DNS with Azure Private DNS</h2><p>In many cases, you might want to prioritize DNS resolution within the Kubernetes cluster but still resolve private domains using Azure Private DNS. This can be achieved by combining the <code>ClusterFirst</code> DNS policy with custom DNS settings.</p><h3 id=-the-clusterfirst-dns-policy>ğŸ“š The <code>ClusterFirst</code> DNS Policy</h3><p>The <code>ClusterFirst</code> DNS policy ensures that DNS queries for Kubernetes Services are resolved using the cluster&rsquo;s DNS service first. If the query isn&rsquo;t resolved within the cluster, it then falls back to external DNS servers, such as Azure Private DNS.</p><h4 id=example-combining-clusterfirst-with-azure-private-dns>Example: Combining <code>ClusterFirst</code> with Azure Private DNS</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>combined-dns-example</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>my-app-image</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsConfig</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nameservers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>10.0.0.4</span><span class=w>  </span><span class=c># Azure Private DNS resolver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>searches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>myprivatedomain.internal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>ClusterFirst</span><span class=w>
</span></span></span></code></pre></div><p>In this configuration:</p><ul><li><strong>ClusterFirst</strong> ensures that internal cluster DNS queries are handled by the Kubernetes DNS service.</li><li>External DNS queries (those not resolved by the cluster) are forwarded to the Azure Private DNS resolver.</li></ul><h3 id=-benefits-of-combining-internal-and-azure-private-dns>âš™ï¸ Benefits of Combining Internal and Azure Private DNS</h3><ul><li><strong>ğŸ› ï¸ Optimized Intra-Cluster Resolution</strong>: Ensures efficient resolution of Services within the Kubernetes cluster.</li><li><strong>ğŸŒ Controlled Private DNS Resolution</strong>: Custom DNS servers, like Azure Private DNS, allow secure resolution of private domain names within your VNet.</li><li><strong>ğŸ” Tailored Search Domains</strong>: Facilitates the resolution of specific private domains without needing fully qualified domain names (FQDNs).</li></ul><h2 id=-comparing-private-domains-resolution-with-external-names>ğŸ”„ Comparing Private Domains Resolution with External Names</h2><p>Kubernetes provides different methods for resolving domains, including using private domains through services like Azure Private DNS and resolving external names via the <code>ExternalName</code> Service. Hereâ€™s a comparison of these approaches:</p><h3 id=-private-domains-with-azure-private-dns>ğŸ” Private Domains with Azure Private DNS</h3><ul><li><strong>Use Case</strong>: Private domains within your organization&rsquo;s Azure VNet, where security and isolation are critical.</li><li><strong>Resolution</strong>: Custom DNS servers (e.g., Azure Private DNS) handle the resolution of internal domain names.</li><li><strong>DNS Management</strong>: You manage the DNS records within the Azure Private DNS Zone.</li><li><strong>Security</strong>: Offers enhanced security by keeping DNS traffic within the private network, ensuring that sensitive resources are not exposed to the public internet.</li></ul><h4 id=example>Example:</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>private-dns-pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>my-app-image</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsConfig</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nameservers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>10.0.0.4</span><span class=w>  </span><span class=c># Azure Private DNS resolver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>searches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>myprivatedomain.internal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>None</span><span class=w>
</span></span></span></code></pre></div><h3 id=-external-names-with-externalname-service>ğŸŒ External Names with <code>ExternalName</code> Service</h3><ul><li><strong>Use Case</strong>: Resolving external domain names, typically public DNS names, to internal or external services.</li><li><strong>Resolution</strong>: Kubernetes automatically maps the Service to a CNAME record that points to an external DNS name.</li><li><strong>DNS Management</strong>: Managed by the external DNS provider (e.g., public DNS for a website).</li><li><strong>Security</strong>: While useful for integrating external services, it may expose internal resources if not configured securely.</li></ul><h4 id=example-1>Example:</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>external-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ExternalName</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>externalName</span><span class=p>:</span><span class=w> </span><span class=l>external-service.com</span><span class=w>
</span></span></span></code></pre></div><h3 id=-key-differences>ğŸ“ Key Differences</h3><ol><li><p><strong>Scope</strong>:</p><ul><li><strong>Private Domains</strong>: Typically used for internal resources within a private network.</li><li><strong>External Names</strong>: Used for mapping Kubernetes Services to external, usually public, domains.</li></ul></li><li><p><strong>Security</strong>:</p><ul><li><strong>Private Domains</strong>: Offers higher security by keeping DNS queries and resolutions within the private network.</li><li><strong>External Names</strong>: May involve public DNS resolution, which could expose certain details if not properly managed.</li></ul></li><li><p><strong>Management</strong>:</p><ul><li><strong>Private Domains</strong>: Managed internally within Azure (or another private DNS provider), giving you full control over DNS records.</li><li><strong>External Names</strong>: Managed by an external DNS provider, which may be less flexible for internal network use cases.</li></ul></li></ol><h2 id=-conclusion>ğŸ Conclusion</h2><p>Kubernetes provides a flexible and robust DNS system that facilitates service discovery within the cluster. By integrating Azure Private DNS, you can securely extend this functionality to resolve private resources within your Azure environment. Combining internal cluster DNS with Azure Private DNS allows you to optimize DNS resolution for both internal Kubernetes services and external private resources, ensuring secure and reliable communication across your applications.</p><p>ğŸš€ With these configurations, your Kubernetes applications will be well-equipped to handle complex networking requirements securely and efficiently, both within the cluster and across private domains in Azure.</p><p>Happy clustering! ğŸŒğŸ”’</p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/blog/how-to-manage-kubernetes-app-storage-like-a-pro-o33/ aria-label="Previous - How to Manage Kubernetes App Storage Like a Pro ğŸ“" class="btn btn-primary"><span class=me-1>â†</span>Previous</a></li><li><a href=/blog/essential-tips-for-setting-resource-limits-in-kubernetes-3b54/ aria-label="Next - Essential Tips for Setting Resource Limits in Kubernetes ğŸ“ˆ" class="btn btn-primary">Next<span class=ms-1>â†’</span></a></li></ul></div></main></div></div><footer class=km-footer role=contentinfo><style>.km-footer{background:#0a2540;color:#fff;padding:15px 0;margin:0;width:100vw;margin-left:calc(50% - 50vw);margin-right:calc(50% - 50vw);border:0;outline:0;padding-left:0;padding-right:0}.km-footer a{color:#00d1b2;text-decoration:none}.km-footer .km-social{display:flex;justify-content:center;gap:20px;margin-top:8px}.km-footer .km-social a{color:#00d1b2!important;font-size:28px;line-height:1;transition:color .2s ease}.km-footer .km-social a:hover{color:#10b981!important}html,body{overflow-x:hidden}</style><div class=text-center><p class=mb-1 style=margin:0>Â© 2025 Kubermates powered by
<a href=https://kapheira.cloud>Kapheira</a> and
<a href=https://www.linkedin.com/in/hamdi-khelil/ rel=author>Hamdi KHELIL</a>.</p><div class=km-social><a href=https://github.com/kubermates-org target=_blank rel=noopener aria-label=GitHub><i class="fab fa-github" aria-hidden=true></i>
</a><a href=https://www.linkedin.com/company/kubermates target=_blank rel=noopener aria-label=LinkedIn><i class="fab fa-linkedin" aria-hidden=true></i>
</a><a href=https://www.youtube.com/@Kubermates target=_blank rel=noopener aria-label=YouTube><i class="fab fa-youtube" aria-hidden=true></i>
</a><a href=https://kubermates.slack.com target=_blank rel=noopener aria-label=Slack><i class="fab fa-slack" aria-hidden=true></i></a></div></div></footer></div><script src=/js/main.min.d844e8cb3c2d74f005336b0c873045728e53ff0ce5534c7d8563fa0676a87b08.js integrity="sha256-2EToyzwtdPAFM2sMhzBFco5T/wzlU0x9hWP6Bnaoewg=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/tabpane-persist.js></script></body></html>